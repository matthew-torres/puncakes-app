<!-- <!DOCTYPE html>
<html>
  <head>
    <title>Product Catalog</title>
  </head>
  <body>
    <h1>Product Catalog</h1>
    <form action="/add_to_cart" method="POST">
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Quantity</th>
            <th>Price</th>
            <th>Ingredients</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          {% for product in products %}
          <tr>
            {% if user_type == false %}
            <td><input type="checkbox" name="product_ids[]" value="{{ product[0] }}"></td>
            {% endif %}
            <td><a href="/product/{{ product[0] }}">{{ product[1] }}</a></td>
            <td>{{ product[2] }}</td>
            <td>${{ product[4] }}</td>
            <td>{{ product[5] }}</td>
            <td>{{ product[6] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% if user_type == false %}
      <input type="submit" value="Add to Cart">
      {% endif %}
    </form>
    <a href="/">Return to Home Page</a>
  </body>
</html> -->

<!DOCTYPE html>
<html>
  <head>
    <title>Product Catalog</title>
  </head>
  <body>
    <h1>Product Catalog</h1>
    <form id="product-form">
      <table>
        <thead>
          <tr>
            <th></th>
            <th>Name</th>
            <th>Quantity</th>
            <th>Price</th>
            <th>Ingredients</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          {% for product in products %}
          <tr>
            <td><input type="checkbox" name="product" value="{{ product[0] }}"></td>
            <td><a href="/product/{{ product[0] }}">{{ product[1] }}</a></td>
            <td>{{ product[2] }}</td>
            <td>${{ product[4] }}</td>
            <td>{{ product[5] }}</td>
            <td>{{ product[6] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <input type="submit" value="Add to Cart">
    </form>
    <a href="/">Return to Home Page</a>
    <script src="app.js"></script>
  </body>
</html>
<script>
const form = document.getElementById("product-form");
form.addEventListener("submit", (event) => {
  event.preventDefault();
  const selectedProducts = [];
  const checkboxes = form.querySelectorAll("input[type='checkbox'][name='product']");
  checkboxes.forEach((checkbox) => {
    if (checkbox.checked) {
      selectedProducts.push(checkbox.value);
    }
  });
  fetch("/add_to_cart", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify(selectedProducts)
  }).then((response) => {
    console.log(response);
  }).catch((error) => {
    console.error(error);
  });
});
</script>

